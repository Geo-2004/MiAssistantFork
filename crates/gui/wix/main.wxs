<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?ifndef CargoPackageVersion?>
  <?define CargoPackageVersion = $(env.CARGO_PKG_VERSION) ?>
  <?endif?>
  <?ifndef CargoTargetBinDir?>
  <?define CargoTargetBinDir = $(env.CARGO_TARGET_BIN_DIR) ?>
  <?endif?>
  <Product Id="*"
           Name="MAF"
           Language="1033"
           Version="$(var.CargoPackageVersion)"
           Manufacturer="HasX"
           UpgradeCode="F2E8C6E4-6B9B-4D1D-9C7E-05E7F3B14F6A">
    <Package InstallerVersion="500" Compressed="yes" InstallScope="perMachine"/>

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed."/>
    <Media Id="1" Cabinet="cab1.cab" EmbedCab="yes"/>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="MiAssistantTool">
          <Component Id="cmpExe" Guid="*">
            <!-- cargo-wix defines CargoTargetBinDir; avoid per-binary variable name issues -->
            <File Id="fileGuiExe" Source="$(var.CargoTargetBinDir)\miassistant-gui.exe" Name="miassistant-gui.exe"/>
            <Shortcut Id="startmenuShortcut" Directory="ProgramMenuFolder" Name="MAF" WorkingDirectory="INSTALLFOLDER" Advertise="no" Target="[#fileGuiExe]" />
          </Component>
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder" Name="Programs"/>
    </Directory>

    <Feature Id="Complete" Title="MAF" Level="1">
      <ComponentRef Id="cmpExe"/>
    </Feature>

  <Icon Id="MAFIcon" SourceFile="appicon.ico" />
  <Property Id="ARPPRODUCTICON" Value="MAFIcon" />
  </Product>
</Wix>
